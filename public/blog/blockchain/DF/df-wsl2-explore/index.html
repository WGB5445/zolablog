<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.core.min.js"></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>

    <link rel="icon" href="/favicon.ico?h=bcf75587c3882a146073">
    <script defer="defer" src="/index_bundle.js?h=065f2dfcb59ed1e17878">

    </script>
    <link href="/main.css?h=2748926f6399f9ea20a8" rel="stylesheet">
  </head>
  <title>WGB's Blog</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="&#x2F;">WGB'小破站</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="&#x2F;">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="&#x2F;/blog">Blog</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="&#x2F;/tools">Tool</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="&#x2F;/about">About</a>
              </li>
            </ul>
            <!-- <button class="btn btn-outline-success me-2" id="wallet_connect" type="button">Connect</button> -->
          </div>
        </div>
    </nav>
    
<div style="background-color: #e4e6eb;">
    <div class="container-xxl">
      <div class="row">
        <div class="col-8"  style="background-color: #ffffff;">
          
          <h1 class="title">
            
          </h1>
  
          


  <h1 class="title" style="padding-bottom: 4px;font-size: 2.5em;line-height: 1.5;">
    黑暗森林DF显卡开图(WSL2)
  </h1>
  <p class="subtitle"><strong>2021-12-07T12:19:32</strong></p>
  <div data-bs-spy="scroll" data-bs-target="#navbar-example3" data-bs-smooth-scroll="true" class="scrollspy-example-2" tabindex="0" >
    <article>
      <blockquote>
<p>本文作者: <a href="https://wgb5445.github.io/">WGB</a></p>
</blockquote>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>      Twitter: [WGB5445](https://twitter.com/WGB5445)
</span></code></pre>
<h3 id="suo-xu-gong-ju">所需工具</h3>
<ul>
<li>Windows 电脑</li>
<li>10 系以上显卡</li>
<li>网络</li>
</ul>
<h3 id="cao-zuo-guo-cheng">操作过程</h3>
<ol>
<li>升级 Windows 系统为预览版</li>
<li>安装 WSL2 内核、安装或升级 WSL ubuntu 为 WSL2</li>
<li>安装显卡的 WSL 驱动</li>
<li>下载 ubuntu 上必要的工具</li>
<li>安装 ubuntu 的 cuda 工具</li>
<li>下载源码</li>
<li>编译</li>
<li>执行</li>
<li>修改浏览器设置</li>
<li>成功开图</li>
</ol>
<h2 id="yi-sheng-ji-windows-xi-tong-wei-yu-lan-ban-huo-windows11">一、升级 Windows 系统为预览版或 Windows11</h2>
<p>为了在 WSL2 上启用 NVIDIA CUDA，需要将系统升级为 Windows 10 的 Windows 预览体验计划或者 Windows 11<br />
对于 Windows 10，需要先注册 Windows 预览体验计划，并升级预览体验成员版本<br />
需要升级为 windows10 预览版内部版本 19044.1263 或更高版本<br />
可以按照微软官方的步骤进行注册升级<br />
<a href="https://insider.windows.com/zh-cn/getting-started#register">https://insider.windows.com/zh-cn/getting-started#register</a></p>
<h2 id="er-an-zhuang-wsl2-nei-he-yi-ji-ubuntu">二、安装 WSL2 内核以及 Ubuntu</h2>
<p>在升级为预览版以后 WSL2 就可以支持调用显卡资源，安装 WSL2 以及 Ubuntu 可以使用命令一键安装，也可以手动逐个安装</p>
<h3 id="1-wan-zheng-de-an-zhuang-bu-zou">1. 完整的安装步骤</h3>
<p>可以使用官网步骤进行下载并安装<br />
<a href="https://docs.microsoft.com/zh-cn/windows/wsl/install">https://docs.microsoft.com/zh-cn/windows/wsl/install</a></p>
<h3 id="2-yi-jian-an-zhuang">2. 一键安装</h3>
<p>也可以使用命令行进行简便安装</p>
<pre data-lang="PowerShell" style="background-color:#2b303b;color:#c0c5ce;" class="language-PowerShell "><code class="language-PowerShell" data-lang="PowerShell"><span>wsl --install
</span></code></pre>
<p>此命令将启用所需的可选组件，下载最新的 Linux 内核，将 WSL 2 设置为默认值，并安装 Linux 发行版（默认安装 Ubuntu）。</p>
<h2 id="san-an-zhuang-wsl-cuda-qu-dong">三、安装 WSL-Cuda 驱动</h2>
<p>由于系统默认不提供显卡-WSL2 的驱动，所以需要自行下载驱动，可以从英伟达官网进行下载<br />
<a href="https://developer.nvidia.com/cuda/wsl">https://developer.nvidia.com/cuda/wsl</a></p>
<h3 id="1-xuan-ze-get-cuda-driver">1. 选择 Get CUDA Driver</h3>
<img src="./DF_WSL2_Explore/驱动官网.png">
<h3 id="2-xia-zai">2. 下载</h3>
<p>根据显卡型号选择对应驱动<br />
<img src="./DF_WSL2_Explore/驱动官网2.png"></p>
<h3 id="3-an-zhuang">3. 安装</h3>
<p>下载后，按默认方法安装即可</p>
<h2 id="si-ubuntu-shang-xia-zai-bi-yao-gong-ju">四、Ubuntu 上下载必要工具</h2>
<p>由于接下来需要编译代码，所以需要安装一系列的工具进行编译
<strong>注意:如果已经有编译好的 df-explorer 可以跳过</strong></p>
<h3 id="1-she-zhi-mi-ma">1. 设置密码</h3>
<p>新下载的 Ubuntu 需要等待安装一小会后，设置用户名及其密码<br />
设置用户名及其密码的过程需要注意:</p>
<ul>
<li>输入用户名后回车即可</li>
<li>输入密码时屏幕不显示字符</li>
<li>输入完成后直接回车即可</li>
<li>再次输入密码即可进入 Ubuntu 系统中</li>
</ul>
<h3 id="2-an-zhuang-gong-ju">2. 安装工具</h3>
<p>这一步使用命令行进行安装，安装需要良好的网络环境<br />
国内用户可以选择国内镜像源安装，速度可达 3MB 每秒
输入命令后可能需要输入密码，密码为上一小步设置的密码</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>sudo apt install -y git libgmp-dev cmake openssl libssl-dev nvidia-cuda-toolkit
</span></code></pre>
<h2 id="wu-xia-zai-cuda-gong-ju-bao">五、下载 CUDA 工具包</h2>
<p>为了在 Ubuntu 下编译 CUDA 的程序，需要安装 CUDA 工具包
所需的安装包可以在英伟达官网链接中获取(官网中同样是通过命令行的方式获取)
<a href="https://developer.nvidia.com/cuda-downloads?target_os=Linux&amp;target_arch=x86_64&amp;Distribution=WSL-Ubuntu&amp;target_version=2.0&amp;target_type=deb_local">官网链接</a><br />
这一步需要依次执行下列命令</p>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">wget</span><span> https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-wsl-ubuntu.pin
</span></code></pre>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">sudo</span><span> mv cuda-wsl-ubuntu.pin /etc/apt/preferences.d/cuda-repository-pin-600
</span></code></pre>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">wget</span><span> https://developer.download.nvidia.com/compute/cuda/11.5.1/local_installers/cuda-repo-wsl-ubuntu-11-5-local_11.5.1-1_amd64.deb
</span></code></pre>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">sudo</span><span> dpkg</span><span style="color:#bf616a;"> -i</span><span> cuda-repo-wsl-ubuntu-11-5-local_11.5.1-1_amd64.deb
</span></code></pre>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">sudo</span><span> apt-key add /var/cuda-repo-wsl-ubuntu-11-5-local/7fa2af80.pub
</span></code></pre>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">sudo</span><span> apt-get update
</span></code></pre>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">sudo</span><span> apt-get</span><span style="color:#bf616a;"> -y</span><span> install cuda
</span></code></pre>
<p>如果所有命令均无出错，可以视为安装成功</p>
<h2 id="liu-xia-zai-yuan-ma">六、下载源码</h2>
<p>使用 Git 工具下载最新的 df-explorer 源码</p>
<h3 id="1-xia-zai-core-yuan-ma">1. 下载 core 源码</h3>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">git</span><span> clone https://github.com/guild-w/df-explorer.git
</span></code></pre>
<h3 id="2-jin-ru-dao-di-san-fang-cha-jian-wen-jian-jia">2. 进入到第三方插件文件夹</h3>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#96b5b4;">cd</span><span> df-explorer/thirdparty
</span></code></pre>
<h3 id="3-xia-zai-cgbn-yuan-ma">3. 下载 CGBN 源码</h3>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">git</span><span> clone https://github.com/NVlabs/CGBN.git
</span></code></pre>
<h3 id="4-xia-zai-workflow-yuan-ma">4. 下载 workflow 源码</h3>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">git</span><span> clone https://github.com/sogou/workflow.git
</span></code></pre>
<h2 id="qi-bian-yi">七、编译</h2>
<p>编译源码需要使用到之前下载的工具包，同样是执行命令</p>
<h3 id="1-bian-yi-workflow">1. 编译 workflow</h3>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#96b5b4;">cd</span><span> workflow &amp;&amp; </span><span style="color:#bf616a;">make
</span></code></pre>
<h3 id="2-hui-dao-df-explorer-mu-lu">2. 回到 df-explorer 目录</h3>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#96b5b4;">cd</span><span> ../../
</span></code></pre>
<h3 id="3-chuang-jian-build-wen-jian-jia-bing-jin-ru">3. 创建 build 文件夹并进入</h3>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">mkdir</span><span> build &amp;&amp; </span><span style="color:#96b5b4;">cd</span><span> build
</span></code></pre>
<h3 id="4-bian-yi-release-ban-df-explorer">4. 编译 Release 版 df-explorer</h3>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">cmake</span><span> ..</span><span style="color:#bf616a;"> -DCMAKE_BUILD_TYPE</span><span>=Release
</span><span style="color:#bf616a;">make
</span></code></pre>
<p>最后在文件夹中生成 df-explorer 文件，可以使用 ls 命令查看</p>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">ls
</span></code></pre>
<p>出现</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>CMakeCache.txt  CMakeFiles  Makefile  cmake_install.cmake  df-explorer  samples
</span></code></pre>
<p>里面的 df-explorer 就是最终的可执行文件</p>
<h2 id="ba-yun-xing-df-explorer">八、运行 df-explorer</h2>
<p>成功编译了 df-explorer 后，可以使用./def-explorer 的方式运行软件</p>
<pre data-lang="sh" style="background-color:#2b303b;color:#c0c5ce;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#bf616a;">./df-explorer
</span></code></pre>
<p>如果成功出现以下的提示则为成功(运行成功后界面不可关闭，否则程序将中断)</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>cuda block size :128
</span><span>cuda device id: 0
</span><span>start server on port 8880
</span></code></pre>
<h2 id="jiu-liu-lan-qi-kai-qi-bu-an-quan-nei-rong-quan-xian">九、浏览器开启不安全内容权限</h2>
<p>由于 DF 游戏网页采用 HTTPS 协议，但是开图程序使用 http 协议，在默认的浏览器设置中不可以在 HTTPS 的网页中带有 HTTP 协议的请求<br />
所以需要修改浏览器设置，并对 DF 的游戏网页设置不安全内容权限</p>
<h3 id="1-chrome">1. chrome</h3>
<p>对于 Chrome 用户可以访问以下链接设置不安全内容权限</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>chrome://settings/content/insecureContent
</span></code></pre>
<p>在&quot;允许显示不安全内容&quot;的栏中添加 DF 网址后刷新网页即可</p>
<h3 id="2-edge">2. Edge</h3>
<p>对于 Edge 用户可以访问以下链接设置不安全内容权限</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>edge://settings/content/insecureContent
</span></code></pre>
<p>在&quot;允许&quot;的栏中添加 DF 网址后刷新网页即可</p>
<h2 id="shi-remote-explorer-cha-jian-tian-jia-lian-jie">十、remote-explorer 插件添加链接</h2>
<p>由于是本机链接，所以添加如下链接即可开图</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>http://localhost:8880/explore
</span></code></pre>

    </article>
  </div>




        </div>
        
        <div class="col-4">
          <div class="card mb-3" style="max-width: 360px;">
            <div class="row g-0">
              <div class="col-md-4">
                <img src="..." class="img-fluid rounded-start" alt="...">
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <h5 class="card-title">不霁何虹</h5>
                  <p class="card-text">Web3.0 builder Move developer</p>
                  <p class="card-text"><small class="text-muted"></small></p>
                </div>
              </div>
            </div>
          </div>

          


          <div class="position-sticky" style="top: 2rem;">
            <nav id="navbar-example3" class="h-100 flex-column align-items-stretch pe-4 border-end"  style="background-color: #ffffff;">
              <nav class="nav nav-pills flex-column">
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#suo-xu-gong-ju">所需工具</a>
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#cao-zuo-guo-cheng">操作过程</a>
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#yi-sheng-ji-windows-xi-tong-wei-yu-lan-ban-huo-windows11">一、升级 Windows 系统为预览版或 Windows11</a>
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#er-an-zhuang-wsl2-nei-he-yi-ji-ubuntu">二、安装 WSL2 内核以及 Ubuntu</a>
                  
                    <nav class="nav nav-pills flex-column">
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#1-wan-zheng-de-an-zhuang-bu-zou">1. 完整的安装步骤</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#2-yi-jian-an-zhuang">2. 一键安装</a>
                    
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#san-an-zhuang-wsl-cuda-qu-dong">三、安装 WSL-Cuda 驱动</a>
                  
                    <nav class="nav nav-pills flex-column">
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#1-xuan-ze-get-cuda-driver">1. 选择 Get CUDA Driver</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#2-xia-zai">2. 下载</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#3-an-zhuang">3. 安装</a>
                    
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#si-ubuntu-shang-xia-zai-bi-yao-gong-ju">四、Ubuntu 上下载必要工具</a>
                  
                    <nav class="nav nav-pills flex-column">
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#1-she-zhi-mi-ma">1. 设置密码</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#2-an-zhuang-gong-ju">2. 安装工具</a>
                    
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#wu-xia-zai-cuda-gong-ju-bao">五、下载 CUDA 工具包</a>
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#liu-xia-zai-yuan-ma">六、下载源码</a>
                  
                    <nav class="nav nav-pills flex-column">
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#1-xia-zai-core-yuan-ma">1. 下载 core 源码</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#2-jin-ru-dao-di-san-fang-cha-jian-wen-jian-jia">2. 进入到第三方插件文件夹</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#3-xia-zai-cgbn-yuan-ma">3. 下载 CGBN 源码</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#4-xia-zai-workflow-yuan-ma">4. 下载 workflow 源码</a>
                    
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#qi-bian-yi">七、编译</a>
                  
                    <nav class="nav nav-pills flex-column">
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#1-bian-yi-workflow">1. 编译 workflow</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#2-hui-dao-df-explorer-mu-lu">2. 回到 df-explorer 目录</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#3-chuang-jian-build-wen-jian-jia-bing-jin-ru">3. 创建 build 文件夹并进入</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#4-bian-yi-release-ban-df-explorer">4. 编译 Release 版 df-explorer</a>
                    
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#ba-yun-xing-df-explorer">八、运行 df-explorer</a>
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#jiu-liu-lan-qi-kai-qi-bu-an-quan-nei-rong-quan-xian">九、浏览器开启不安全内容权限</a>
                  
                    <nav class="nav nav-pills flex-column">
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#1-chrome">1. chrome</a>
                    
                      <a class="nav-link ms-3 my-1" href="/blog/blockchain/DF/df-wsl2-explore/#2-edge">2. Edge</a>
                    
                  
                
                  <a class="nav-link" href="/blog/blockchain/DF/df-wsl2-explore/#shi-remote-explorer-cha-jian-tian-jia-lian-jie">十、remote-explorer 插件添加链接</a>
                  
                
              </nav>
            </nav>
          </div>





          
          
        </div>
      </div>
    </div>
  </div>
  

</body>

</html>